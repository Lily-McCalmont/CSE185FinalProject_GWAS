Plink commands and data used in lab 3:

%pylab inline
import os
import pandas as pd
from qqman import qqman

# In Progress
plink --vcf ~/teams/7/efm_clade.vcf.gz --linear --maf 0.05 --pheno ~/teams/7/efm_clade.streptomycin_phenotype.phen --allow-no-sex --out test_gwas
plink --vcf ~/teams/7/efm_clade.vcf.gz --pca 3 --out test_gwas
plink --vcf ~/teams/7/efm_clade.vcf.gz --linear hide-covar --maf 0.05 --covar lab3_gwas.eigenvec --pheno ~/public/lab3/lab3_gwas.phen --allow-no-sex --out test_gwas_covar
bcftools norm -d all ~/teams/7/efm_clade.vcf.gz -o ~/lab3-spring23/lab3_gwas_nodup.vcf.gz -O z
plink --vcf ~/lab3-spring23/lab3_gwas_nodup.vcf.gz --clump test_gwas_covar.assoc.linear


Plotting: Manhattan and QQ plots
from qqman import qqman
data = pd.read_csv("lab3_gwas.assoc.linear", delim_whitespace=True)
fig, (ax0, ax1) = plt.subplots(1, 2, gridspec_kw={'width_ratios': [2, 1]})
fig.set_size_inches((15, 5))
qqman.manhattan(data, ax=ax0)
qqman.qqplot(data, ax=ax1)
